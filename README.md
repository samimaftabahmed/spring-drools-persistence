# spring-drools-persistence

Sample project to demonstrate the integration of persistent aware `KieSession` of Drools with Spring Boot.

When executing on Java 17 use the following VM option
```dtd
--add-opens java.base/java.lang=ALL-UNNAMED
```
The `KieSession` here is persisted to **MySQL**

Exception Stacktrace after changing the value of OPTLOCK field from a different application

```dtd
Female
2021-03-28 15:11:13.405 DEBUG 9712 --- [nio-8080-exec-5] org.hibernate.SQL                        : update SessionInfo set lastModificationDate=?, rulesByteArray=?, startDate=?, OPTLOCK=? where id=? and OPTLOCK=?
2021-03-28 15:11:13.405 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [1] as [TIMESTAMP] - [Sun Mar 28 15:11:13 IST 2021]
2021-03-28 15:11:13.406 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [2] as [BLOB] - [[-84, -19, 0, 5, 122, 0, 0, 4, 0, 10, 6, 8, 7, 16, 47, 24, 0, 74, -128, 4, 8, 0, 18, 72, 111, 114, 103, 46, 100, 114, 111, 111, 108, 115, 46, 99, 111, 114, 101, 46, 109, 97, 114, 115, 104, 97, 108, 108, 105, 110, 103, 46, 105, 109, 112, 108, 46, 83, 101, 114, 105, 97, 108, 105, 122, 97, 98, 108, 101, 80, 108, 97, 99, 101, 104, 111, 108, 100, 101, 114, 82, 101, 115, 111, 108, 118, 101, 114, 83, 116, 114, 97, 116, 101, 103, 121, 26, -79, 3, -84, -19, 0, 5, 115, 114, 0, 19, 106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 65, 114, 114, 97, 121, 76, 105, 115, 116, 120, -127, -46, 29, -103, -57, 97, -99, 3, 0, 1, 73, 0, 4, 115, 105, 122, 101, 120, 112, 0, 0, 0, 11, 119, 4, 0, 0, 0, 11, 115, 114, 0, 44, 99, 111, 109, 46, 115, 97, 109, 46, 115, 112, 114, 105, 110, 103, 100, 114, 111, 111, 108, 115, 112, 101, 114, 115, 105, 115, 116, 101, 110, 99, 101, 46, 109, 111, 100, 101, 108, 46, 80, 101, 114, 115, 111, 110, 125, 46, -103, 57, -17, -93, 104, -124, 2, 0, 5, 73, 0, 3, 97, 103, 101, 76, 0, 6, 103, 101, 110, 100, 101, 114, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 76, 0, 4, 110, 97, 109, 101, 113, 0, 126, 0, 3, 76, 0, 15, 116, 111, 67, 111, 109, 112, 97, 114, 101, 71, 101, 110, 100, 101, 114, 113, 0, 126, 0, 3, 76, 0, 13, 116, 111, 67, 111, 109, 112, 97, 114, 101, 78, 97, 109, 101, 113, 0, 126, 0, 3, 120, 112, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 116, 0, 7, 67, 104, 114, 105, 115, 116, 121, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 113, 0, 126, 0, 7, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 113, 0, 126, 0, 11, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 113, 0, 126, 0, 15, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 113, 0, 126, 0, 7, 112, 112, 115, 113, 0, 126, 0, 2, 0, 0, 0, 0, 112, 113, 0, 126, 0, 11, 112, 112, 120, 82, -18, 5, 8, 0, 16, 0, 26, -29, 5, 24, 3, 32, 3, 50, 6, 8, 1, 16, 0, 24, 0, 66, -48, 3, 26, 25, 10, 4, 77, 65, 73, 78, 16, 0, 24, 1, 32, 3, 40, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 64, 0, 34, 6, 10, 4, 77, 65, 73, 78, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 1, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 2, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 2, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 2, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 3, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 50, 37, 18, 2, 8, 3, 24, 0, 34, 10, 100, 101, 102, 97, 117, 108, 116, 112, 107, 103, 42, 13, 80, 101, 114, 115, 111, 110, 32, 70, 101, 109, 97, 108, 101, 64, 0, 88, 0, 82, -127, 2, 10, 7, 68, 69, 70, 65, 85, 76, 84, 119, -4, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 0, 88, 0, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 1, 88, 0, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 2, 88, 0, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 3, 88, 0, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 4, 88, 0, 18, 16, 8, 2, 16, 1, 24, 1, 64, 0, 74, 4, 0, 0, 0, 5, 88, 0, 18, 16, 8, 2, 16, 2, 24, 2, 64, 0, 74, 4, 0, 0, 0, 6, 88, 0, 18, 16, 8, 2, 16, 2, 24, 2, 64, 0, 74, 4, 0, 0, 0, 7, 88, 0, 18, 16, 8, 2, 16, 2, 24, 2, 64, 0, 74, 4, 0, 0, 0, 8, 88, 0, 18, 16, 8, 2, 16, 3, 24, 3, 64, 0, 74, 4, 0, 0, 0, 9, 88, 0, 18, 16, 8, 2, 16, 3, 24, 3, 64, 0, 74, 4, 0, 0, 0, 10, 88, 0, 34, 48, 10, 44, 99, 111, 109, 46, 115, 97, 109, 46, 115, 112, 114, 105, 110, 103, 100, 114, 111, 111, 108, 115, 112, 101, 114, 115, 105, 115, 116, 101, 110, 99, 101, 46, 109, 111, 100, 101, 108, 46, 80, 101, 114, 115, 111, 110, 16, 0, 34, 2, 104, 0]]
2021-03-28 15:11:13.406 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [3] as [TIMESTAMP] - [2021-03-25 19:08:23.772]
2021-03-28 15:11:13.406 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [4] as [INTEGER] - [19]
2021-03-28 15:11:13.406 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [5] as [BIGINT] - [1]
2021-03-28 15:11:13.406 TRACE 9712 --- [nio-8080-exec-5] o.h.type.descriptor.sql.BasicBinder      : binding parameter [6] as [INTEGER] - [18]
2021-03-28 15:11:13.415 ERROR 9712 --- [nio-8080-exec-5] o.s.t.s.TransactionSynchronizationUtils  : TransactionSynchronization.beforeCompletion threw exception

javax.persistence.OptimisticLockException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.drools.persistence.info.SessionInfo#1]
at org.hibernate.internal.ExceptionConverterImpl.wrapStaleStateException(ExceptionConverterImpl.java:226) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:93) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:181) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:188) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1367) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1350) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_271]
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_271]
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_271]
at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_271]
at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:366) ~[spring-orm-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at com.sun.proxy.$Proxy78.flush(Unknown Source) ~[na:na]
at org.drools.persistence.TriggerUpdateTransactionSynchronization.beforeCompletion(TriggerUpdateTransactionSynchronization.java:76) ~[drools-persistence-jpa-7.47.0.Final.jar:7.47.0.Final]
at org.kie.spring.persistence.SpringTransactionSynchronizationAdapter.beforeCompletion(SpringTransactionSynchronizationAdapter.java:54) ~[kie-spring-7.47.0.Final.jar:7.47.0.Final]
at org.springframework.transaction.support.TransactionSynchronizationUtils.triggerBeforeCompletion(TransactionSynchronizationUtils.java:107) ~[spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.support.AbstractPlatformTransactionManager.triggerBeforeCompletion(AbstractPlatformTransactionManager.java:932) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:728) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:633) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:386) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) [spring-tx-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) [spring-aop-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) [spring-aop-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) [spring-aop-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at com.sam.springdroolspersistence.controller.MyController$$EnhancerBySpringCGLIB$$c1fd3114.firePerson(<generated>) [classes/:na]
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_271]
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_271]
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_271]
at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_271]
at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at javax.servlet.http.HttpServlet.service(HttpServlet.java:626) [tomcat-embed-core-9.0.37.jar:4.0.FR]
at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) [tomcat-embed-core-9.0.37.jar:4.0.FR]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.8.RELEASE.jar:5.2.8.RELEASE]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:373) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1589) [tomcat-embed-core-9.0.37.jar:9.0.37]
at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.37.jar:9.0.37]
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_271]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_271]
at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.37.jar:9.0.37]
at java.lang.Thread.run(Thread.java:748) [na:1.8.0_271]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.drools.persistence.info.SessionInfo#1]
at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:2605) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:3449) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:3312) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:3726) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:201) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:604) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:478) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at java.util.LinkedHashMap.forEach(LinkedHashMap.java:684) ~[na:1.8.0_271]
at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:475) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:348) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:102) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1363) ~[hibernate-core-5.4.20.Final.jar:5.4.20.Final]
... 70 common frames omitted
```
